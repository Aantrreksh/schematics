---

copyright:
  years: 2017, 2023
lastupdated: "2023-03-31"

keywords: schematics agent planning, planning agent, agent planning, command-line, api, ui

subcollection: schematics

---

{{site.data.keyword.attribute-definition-list}}

{{site.data.keyword.bplong_notm}} Agent beta-1 delivers a simplified agent installation process. You can review the [beta-1 release](/docs/schematics?topic=schematics-schematics-relnotes&interface=cli#schematics-mar2223) documentation and explore. 
{: attention}

{{site.data.keyword.bpshort}} Agent is a [beta-1 feature](/docs/schematics?topic=schematics-agent-beta1-limitations) that is available for evaluation and testing purposes. It is not intended for production usage.
{: beta}

# Preparing for agent deployment
{: #plan-agent-overview}

Agents for {{site.data.keyword.bplong}} extends its ability to work directly with your cloud infrastructure on your private network or any isolated network zones. Agents allow users to be in control of their own network configuration and the network access that they give to the agent to execute Terraform and Ansible jobs. Agents are designed not to require inbound access from {{site.data.keyword.bpshort}} and the opening of inbound firewall or network access ports. All communication between the agent and Schematics is outbound from the agent and under user control.    

{{site.data.keyword.bpshort}} Agents is a collection of microservices that are deployed in your Kubernetes cluster on {{site.data.keyword.cloud}}. It uses an {{site.data.keyword.objectstorageshort}} bucket as an intermediate or temporary datastore for the log files and state-files generated by the Terraform or Ansible automation.
{: shortdesc}

Review and complete the tasks below to prepare your {{site.data.keyword.cloud_notm}} environment to deploy a new agent.

- **Account and networks:** An agent provides {{site.data.keyword.bpshort}} Schematics the ability to run Terraform and Ansible jobs within a target account and the accounts private network. Network policies must be configured to allow the cluster the agent is deployed on to communicate back to Schematics, also to {{site.data.keyword.cloud}} APIs, services and for instance to a users private Git or Vault instances. 
   - Record information about the allowed network zones and access.    
- **Kubernetes cluster:** A {{site.data.keyword.bpshort}} agent can be deployed on any existing private or public infrastructure such as [{{site.data.keyword.containerlong_notm}}](/docs/containers?topic=containers-clusters), [{{site.data.keyword.vpc_full}}](/docs/openshift?topic=openshift-cluster-create-vpc-gen2&interface=ui), or [{{site.data.keyword.redhat_openshift_full}}](/openshift?topic=openshift-clusters) clusters. You can use an existing cluster or provision a new cluster with the following minimum configuration.
   - Minimum configuration: Three worker nodes with `b4x16` flavor. This configuration can be used to run four Terraform or Ansible automation jobs in parallel.
   - Record information about the cluster such as `cluster ID`, `cluster resource group`,  and `location` for the later use.
- **{{site.data.keyword.cos_full_notm}}:** The {{site.data.keyword.bpshort}} Agent uses {{site.data.keyword.objectstorageshort}} bucket to store temporary data. You must provision a new bucket for an agent in the same region or one close to where the agent's Kubernetes cluster is provisioned.
    - To deploy an agent, you must have the necessary privileges to create the `HMAC credentials` for the {{site.data.keyword.objectstorageshort}} bucket and store the credential as Kubernetes secret.
    - Record information about the COS resources such as `COS instance name`, `COS bucket name`, `COS bucket region`, and `COS resource group` for the later use.
- **IAM access permission:** At a minimum you must have access permissions for the Kubernetes service, Resource Group, {{site.data.keyword.objectstorageshort}}, and the {{site.data.keyword.bpshort}} service to [deploy an agent](/docs/schematics?topic=schematics-deploy-agent-overview&interface=cli).
    - When deploying an agent in another, or using a `ServiceID` or `APIKey`, you must ensure that the account administrator has granted the required permission for all the services enlisted in [permission to deploy an agent](/docs/schematics?topic=schematics-access#agent-permissions).
- **{{site.data.keyword.cloud_notm}} CLI:** Use the latest version of {{site.data.keyword.cloud_notm}} CLI and the [{{site.data.keyword.bpshort}} CLI v1.12.8](/docs/schematics?topic=schematics-setup-cli#install-schematics-plugin) or higher plugin to install an agent. For more information about plugin installation, see [installing {{site.data.keyword.bpshort}} CLI plugin](/docs/schematics?topic=schematics-setup-cli#install-schematics-plugin).

You can deploy only one agent instance in a Kubernetes cluster. To deploy multiple agents in a single {{site.data.keyword.cloud_notm}} account, they must be on a different Kubernetes cluster. Each agent and cluster catering to different network isolation zones in your Cloud environment.
{: note}

In this Beta release, an agent can only be associated with and run jobs for one {{site.data.keyword.cloud_notm}} account. Agents cannot be shared with other accounts or run jobs for multiple accounts. 

You are advised to monitor the resource usage for the {{site.data.keyword.bpshort}} Agent pods to scale the worker nodes in the Kubernetes cluster. In the Beta-1 release, you can use the **Kubernetes dashboard** or [kubectl](/docs/containers?topic=containers-cs_cli_install#kubectl) commands to make changes to:   
    - the number of concurrent Terraform, and Ansible jobs.
    - the number of Terraform, and Ansible pods.
    - the resource limits for the agent deployment.


## Next steps
{: #agent-plan-nextsteps}

The next step is to [deploy an agent](/docs/schematics?topic=schematics-deploy-agent-overview).
